(function(){var domain=location.origin,path=location.pathname,query=location.search,hash=location.hash,ua=navigator.userAgent,url;if(/Android|iPhone|iPad/.test(ua)){if(/\/sp\/+/.test(path))return;location.href='/sp'+path+query+hash;}else{if(!/\/sp\/+/.test(path))return;path=path.replace(/\/sp\/+/,'/');url=(path+query+hash).replace(/\/\//,'');location.href=url;}}());window.onunload=function(){};window.onpageshow=function(event){if(event.persisted){window.location.reload();}};var ASTERISK=ASTERISK||{};(function(){var userAgent=window.navigator.userAgent.toLowerCase();function detect_sp(){if(userAgent.match(/iphone|ipodtouch|ipad/)!=null){return'sp ios';}else
if(userAgent.match(/android/)!=null){return'sp android';}else{return'desktop';}}ASTERISK.device=detect_sp();ASTERISK.isSP=ASTERISK.device.match(/sp/);})();function trimTxt($tgt,limit){var length=$tgt.text().length;var trimmedTxt=$tgt.text().substr(0,limit);if(length>limit){$tgt.html(trimmedTxt+'â€¦');}else{$tgt.html(trimmedTxt);}}$(function(){function pageInit(){ASTERISK.c_page=$('body').attr('class');if(ASTERISK.c_page!='top'){$(window).on('load',stickyNav);setGradborder();setHeadArrow();setSideNav();if($('html').hasClass('lt-ie9')||ASTERISK.isSP)$('body').addClass('noCanvasBg');if(ASTERISK.c_page!='news'&&ASTERISK.c_page!='goods'&&ASTERISK.c_page!='ast36')setFootArrow();}$('.newsTicker .ticker').find('li a').each(function(){trimTxt($(this),60);});$('.twitterFeed .ticker').find('li').each(function(){trimTxt($(this),60);});}pageInit();function stickyNav(){var sidenav=$('.sidenav');var offset=sidenav.offset();var ftpos=$('footer').offset().top;var navH=sidenav.height();var fxpos=10;$(window).on('scroll resize load',function(){var scrtop=$(window).scrollTop();var edge=scrtop+navH;var WH=$(window).height();if(WH<=navH){sidenav.removeClass('fixed').css({top:offset.top});return;}if(scrtop>=(offset.top-fxpos)&&edge<ftpos){sidenav.addClass('fixed').css({top:fxpos});}else if(edge>=ftpos){sidenav.removeClass('fixed').css({top:(ftpos-navH)});}else{sidenav.removeClass('fixed').css({top:offset.top});}});}function setGradborder(){$('.gradBorder').prepend('<span class="gbTop"></span>'+'<span class="gbBottom"></span>'+'<span class="gbLeft"></span>'+'<span class="gbRight"></span>');}function setSideNav(){var tgt_class='.'+ASTERISK.c_page;$('.sidenav__menu').find(tgt_class).find('a').addClass('currentMenu');}function setHeadArrow(){var $arrow=$('.pageHeader__next');var $list=$('.pageHeader__nav');var $next=$list.find('.currentMenu').next();var href=$next.find('a').attr('href')||'./';$arrow.attr('href',href);}function setFootArrow(){var $arrow=$('.paginationArrow');var $list=$('.pageHeader__nav');var $next=$list.find('.currentMenu').next();var $prev=$list.find('.currentMenu').prev();var n_href=$next.find('a').attr('href');var p_href=$prev.find('a').attr('href');$arrow.find('.next').attr('href',n_href);$arrow.find('.prev').attr('href',p_href);if(!n_href){$arrow.find('.next').addClass('disable').attr('href','javascript:void(0)');}if(!p_href){$arrow.find('.prev').addClass('disable').attr('href','javascript:void(0)');}}$('a[href^=#]').click(function(){if($(this).hasClass('noscr'))return false;var speed=400;var href=$(this).attr("href");var target=$(href=="#"||href==""?'html':href);var position=target.offset().top;$('body,html').animate({scrollTop:position},speed,'swing');return false;});function setSNS(){$.ajax({url:'http://api.b.st-hatena.com/entry.count'+'?url='+'http://asterisk-war.com',dataType:'jsonp',async:true}).done(function(data){$('.t_hatena').find('.count').text(data);});$.ajax({url:'http://graph.facebook.com/'+'?id='+'http://asterisk-war.com',dataType:'jsonp',async:true}).done(function(data){if(typeof data.shares!=='undefined'){$('.t_facebook').find('.count').text(data.shares);}});$.ajax({url:'http://urls.api.twitter.com/1/urls/count.json'+'?url='+'http://asterisk-war.com',dataType:'jsonp',async:true}).done(function(data){$('.t_twitter').find('.count').text(data.count);});}var $overlay=$('.overlay');var $modal=$('.modal');var $modalOpen=$('.modalOpen');var $modalClose=$('.modal__close,.modal,.overlay');var speed=300;var mc=new ModalController();function ModalController(){this.open=function(id){$overlay.fadeIn(speed);$modal.show();var $tgt=$(id);var scrtop=$(window).scrollTop();var position_y=($(window).height()/2)-($tgt.height()/2);$modal.css({top:scrtop+position_y});if(!$tgt.hasClass('currentModal')){$('.currentModal').hide();$tgt.addClass('currentModal');$tgt.fadeIn(400);$('#hexaGround').css({zIndex:1200});}else{$tgt.hide().removeClass('currentModal');}};this.close=function(e){$('.currentModal').removeClass('currentModal').fadeOut(speed);$overlay.fadeOut(speed);$modal.fadeOut(speed);$('#hexaGround').css({zIndex:0});};}$modalOpen.on('click',function(){var _id=$(this).attr('href');mc.open(_id);return false;});$modalClose.on('click',function(){mc.close();return false;});$('.modal__inner,.modal__pagenation').on('click',function(e){e.stopPropagation();});$('.modal__pagenation').find('p').on('click',function(){var _index=$('.modalContent').index($('.currentModal'));var _max=$('.modalContent').size();var _next=(_index==_max-1)?0:_index+1;var _prev=(_index==0)?_max-1:_index-1;var _direction=$(this).hasClass('next')?_next:_prev;$('.currentModal').hide().removeClass('currentModal');$('.modalContent').eq(_direction).fadeIn(200).addClass('currentModal');});if($.magnificPopup){$('.popup-youtube').magnificPopup({disableOn:700,type:'iframe',mainClass:'mfp-fade',removalDelay:160,preloader:false,fixedContentPos:false});$('.popup').magnificPopup({type:'image',closeOnContentClick:true,image:{verticalFit:false},fixedContentPos:false});}});
